<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mdapy package &mdash; mdapy 0.7.4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/mdapy_favico_white.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="mdapy" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> mdapy
            <img src="_static/mdapy_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.7.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted/examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Mdapy Python API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">mdapy</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">mdapy package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.calculator">mdapy.calculator module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.calculator.Calculator"><code class="docutils literal notranslate"><span class="pre">Calculator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.centro_symmetry_parameter">mdapy.centro_symmetry_parameter module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.centro_symmetry_parameter.CentroSymmetryParameter"><code class="docutils literal notranslate"><span class="pre">CentroSymmetryParameter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.cluser_analysis">mdapy.cluser_analysis module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.cluser_analysis.ClusterAnalysis"><code class="docutils literal notranslate"><span class="pre">ClusterAnalysis</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.common_neighbor_analysis">mdapy.common_neighbor_analysis module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.common_neighbor_analysis.CommonNeighborAnalysis"><code class="docutils literal notranslate"><span class="pre">CommonNeighborAnalysis</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.create_polycrystalline">mdapy.create_polycrystalline module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.create_polycrystalline.Cell"><code class="docutils literal notranslate"><span class="pre">Cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.create_polycrystalline.Container"><code class="docutils literal notranslate"><span class="pre">Container</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.create_polycrystalline.CreatePolycrystalline"><code class="docutils literal notranslate"><span class="pre">CreatePolycrystalline</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.eam_average">mdapy.eam_average module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.eam_average.EAMAverage"><code class="docutils literal notranslate"><span class="pre">EAMAverage</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.eam_generate">mdapy.eam_generate module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.eam_generate.EAMGenerate"><code class="docutils literal notranslate"><span class="pre">EAMGenerate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.entropy">mdapy.entropy module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.entropy.AtomicEntropy"><code class="docutils literal notranslate"><span class="pre">AtomicEntropy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.kdtree">mdapy.kdtree module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.kdtree.kdtree"><code class="docutils literal notranslate"><span class="pre">kdtree</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.lattice_maker">mdapy.lattice_maker module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.lattice_maker.LatticeMaker"><code class="docutils literal notranslate"><span class="pre">LatticeMaker</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.lindemann_parameter">mdapy.lindemann_parameter module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.lindemann_parameter.LindemannParameter"><code class="docutils literal notranslate"><span class="pre">LindemannParameter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.mean_squared_displacement">mdapy.mean_squared_displacement module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.mean_squared_displacement.MeanSquaredDisplacement"><code class="docutils literal notranslate"><span class="pre">MeanSquaredDisplacement</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.mean_squared_displacement.fft"><code class="docutils literal notranslate"><span class="pre">fft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.mean_squared_displacement.ifft"><code class="docutils literal notranslate"><span class="pre">ifft()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.neighbor">mdapy.neighbor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.neighbor.Neighbor"><code class="docutils literal notranslate"><span class="pre">Neighbor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.pair_distribution">mdapy.pair_distribution module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.pair_distribution.PairDistribution"><code class="docutils literal notranslate"><span class="pre">PairDistribution</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.plotset">mdapy.plotset module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.plotset.cm2inch"><code class="docutils literal notranslate"><span class="pre">cm2inch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.plotset.pltset"><code class="docutils literal notranslate"><span class="pre">pltset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.potential">mdapy.potential module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.potential.EAM"><code class="docutils literal notranslate"><span class="pre">EAM</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.spatial_binning">mdapy.spatial_binning module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.spatial_binning.SpatialBinning"><code class="docutils literal notranslate"><span class="pre">SpatialBinning</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.system">mdapy.system module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.system.MultiSystem"><code class="docutils literal notranslate"><span class="pre">MultiSystem</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.system.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.temperature">mdapy.temperature module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.temperature.AtomicTemperature"><code class="docutils literal notranslate"><span class="pre">AtomicTemperature</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.timer">mdapy.timer module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.timer.timer"><code class="docutils literal notranslate"><span class="pre">timer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.void_distribution">mdapy.void_distribution module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.void_distribution.VoidDistribution"><code class="docutils literal notranslate"><span class="pre">VoidDistribution</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.voronoi_analysis">mdapy.voronoi_analysis module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.voronoi_analysis.VoronoiAnalysis"><code class="docutils literal notranslate"><span class="pre">VoronoiAnalysis</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy.warren_cowley_parameter">mdapy.warren_cowley_parameter module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.warren_cowley_parameter.WarrenCowleyParameter"><code class="docutils literal notranslate"><span class="pre">WarrenCowleyParameter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mdapy">Module contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mdapy.init"><code class="docutils literal notranslate"><span class="pre">init()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mdapy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">mdapy</a></li>
      <li class="breadcrumb-item active">mdapy package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mdapy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mdapy-package">
<h1>mdapy package<a class="headerlink" href="#mdapy-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-mdapy.calculator">
<span id="mdapy-calculator-module"></span><h2>mdapy.calculator module<a class="headerlink" href="#module-mdapy.calculator" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.calculator.Calculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.calculator.</span></span><span class="sig-name descname"><span class="pre">Calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_type_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/calculator.html#Calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.calculator.Calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the atomic energy and force based on the given embedded atom method
EAM potential. Multi-elements alloy is also supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential</strong> (<em>mp.EAM</em>) – A EAM class.</p></li>
<li><p><strong>elements_list</strong> (<em>list</em>) – elements need to be calculated. Such as [‘Al’, ‘Fe’].</p></li>
<li><p><strong>init_type_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) per atom type.</p></li>
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
<li><p><strong>neighbor_number</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) neighbor atoms number.</p></li>
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>boundary</strong> (<em>list</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Such as [1, 1, 1].</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>energy</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>) atomic energy (eV).</p></li>
<li><p><strong>force</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) atomic force (eV/A).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">EAM</span><span class="p">(</span><span class="s2">&quot;./example/CoNiFeAlCu.eam.alloy&quot;</span><span class="p">)</span> <span class="c1"># Read a eam.alloy file.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        potential.rc, max_neigh=100) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cal</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Calculator</span><span class="p">(</span>
<span class="go">        potential,</span>
<span class="go">        [&quot;Al&quot;],</span>
<span class="go">        np.ones(FCC.pos.shape[0], dtype=np.int32),</span>
<span class="go">        neigh.verlet_list,</span>
<span class="go">        neigh.distance_list,</span>
<span class="go">        neigh.neighbor_number,</span>
<span class="go">        FCC.pos,</span>
<span class="go">        [1, 1, 1],</span>
<span class="go">        FCC.box,</span>
<span class="go">    ) # Initialize Calculator class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cal</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the atomic energy and force.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cal</span><span class="o">.</span><span class="n">energy</span> <span class="c1"># Check the energy.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cal</span><span class="o">.</span><span class="n">force</span> <span class="c1"># Check the force.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.calculator.Calculator.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/calculator.html#Calculator.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.calculator.Calculator.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real energy and force calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.centro_symmetry_parameter">
<span id="mdapy-centro-symmetry-parameter-module"></span><h2>mdapy.centro_symmetry_parameter module<a class="headerlink" href="#module-mdapy.centro_symmetry_parameter" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.centro_symmetry_parameter.CentroSymmetryParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.centro_symmetry_parameter.</span></span><span class="sig-name descname"><span class="pre">CentroSymmetryParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/centro_symmetry_parameter.html#CentroSymmetryParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.centro_symmetry_parameter.CentroSymmetryParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to compute the CentroSymmetry Parameter (CSP),
which is heluful to recgonize the structure in lattice, such as FCC and BCC.
The  CSP is given by:</p>
<div class="math notranslate nohighlight">
\[p_{\mathrm{CSP}} = \sum_{i=1}^{N/2}{|\mathbf{r}_i + \mathbf{r}_{i+N/2}|^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(r_i\)</span> and <span class="math notranslate nohighlight">\(r_{i+N/2}\)</span> are two neighbor vectors from the central atom to a pair of opposite neighbor atoms.
For ideal centrosymmetric crystal, the contributions of all neighbor pairs will be zero. Atomic sites within a defective
crystal region, in contrast, typically have a positive CSP value.</p>
<p>This parameter <span class="math notranslate nohighlight">\(N\)</span> indicates the number of nearest neighbors that should be taken into account when computing
the centrosymmetry value for an atom. Generally, it should be a positive, even integer. Note that larger number decreases the
calculation speed. For FCC is 12 and BCC is 8.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this module in publication, you should also cite the original paper.
<a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.58.11085">Kelchner C L, Plimpton S J, Hamilton J C. Dislocation nucleation and defect
structure during surface indentation[J]. Physical review B, 1998, 58(17): 11085.</a>.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The CSP is calculated by the <a class="reference external" href="https://docs.lammps.org/compute_centro_atom.html">same algorithm as LAMMPS</a>.
First calculate all <span class="math notranslate nohighlight">\(N (N - 1) / 2\)</span> pairs of neighbor atoms, and the summation of the <span class="math notranslate nohighlight">\(N/2\)</span> lowest weights
is CSP values.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – Neighbor number.</p></li>
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box.</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>, </em><em>optional</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Defaults to [1, 1, 1].</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>csp</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>) CSP value per atoms.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CSP</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">CentroSymmetryParameter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># Initialize CSP class</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CSP</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the csp per atoms</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CSP</span><span class="o">.</span><span class="n">csp</span> <span class="c1"># Check the csp value</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.centro_symmetry_parameter.CentroSymmetryParameter.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/centro_symmetry_parameter.html#CentroSymmetryParameter.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.centro_symmetry_parameter.CentroSymmetryParameter.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real CSP calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.cluser_analysis">
<span id="mdapy-cluser-analysis-module"></span><h2>mdapy.cluser_analysis module<a class="headerlink" href="#module-mdapy.cluser_analysis" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.cluser_analysis.ClusterAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.cluser_analysis.</span></span><span class="sig-name descname"><span class="pre">ClusterAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/cluser_analysis.html#ClusterAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.cluser_analysis.ClusterAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to divide atoms connected within a given cutoff distance into a cluster.
It is helpful to recognize the reaction products or fragments under shock loading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em>) – cutoff distance.</p></li>
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>particleClusters</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>) cluster ID per atoms.</p></li>
<li><p><strong>cluster_number</strong> (int) - cluster number.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class use the <a class="reference external" href="https://www.ovito.org/docs/current/reference/pipelines/modifiers/cluster_analysis.html#particles-modifiers-cluster-analysis">same method as in Ovito</a>.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">[((</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">*</span><span class="mf">3.615</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">*</span><span class="mf">3.615</span><span class="p">))</span>
<span class="go">                    | ((FCC.pos[:,0]&gt;6*3.615) &amp; (FCC.pos[:,0]&lt; 9*3.615))] # Do a slice operation.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        4., max_neigh=50) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Clus</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">ClusterAnalysis</span><span class="p">(</span><span class="mf">4.</span><span class="p">,</span> <span class="n">neigh</span><span class="o">.</span><span class="n">verlet_list</span><span class="p">,</span> <span class="n">neigh</span><span class="o">.</span><span class="n">distance_list</span><span class="p">)</span> <span class="c1"># Initilize Cluster class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Clus</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Do cluster calculation.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Clus</span><span class="o">.</span><span class="n">cluster_number</span> <span class="c1"># Check cluster number, should be 2 here.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Clus</span><span class="o">.</span><span class="n">particleClusters</span> <span class="c1"># Check atom in which cluster.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Clus</span><span class="o">.</span><span class="n">get_size_of_cluster</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Obtain the atom number in cluster 1.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.cluser_analysis.ClusterAnalysis.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/cluser_analysis.html#ClusterAnalysis.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.cluser_analysis.ClusterAnalysis.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real cluster analysis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.cluser_analysis.ClusterAnalysis.get_size_of_cluster">
<span class="sig-name descname"><span class="pre">get_size_of_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/cluser_analysis.html#ClusterAnalysis.get_size_of_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.cluser_analysis.ClusterAnalysis.get_size_of_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>This method can obtain the number of atoms in cluster <span class="math notranslate nohighlight">\(cluster\_id\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cluster_id</strong> (<em>int</em>) – cluster ID, it should be larger than 0 and lower than total <span class="math notranslate nohighlight">\(cluster\_number\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the number of atoms in given cluster.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.common_neighbor_analysis">
<span id="mdapy-common-neighbor-analysis-module"></span><h2>mdapy.common_neighbor_analysis module<a class="headerlink" href="#module-mdapy.common_neighbor_analysis" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.common_neighbor_analysis.CommonNeighborAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.common_neighbor_analysis.</span></span><span class="sig-name descname"><span class="pre">CommonNeighborAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/common_neighbor_analysis.html#CommonNeighborAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.common_neighbor_analysis.CommonNeighborAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class use Common Neighbor Analysis (CNA) method to recgonize the lattice structure, based
on which atoms can be divided into FCC, BCC, HCP and Other structure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If one use this module in publication, one should also cite the original paper.
<a class="reference external" href="https://doi.org/10.1016/0927-0256(94)90109-0">Faken D, Jónsson H. Systematic analysis of local atomic structure combined with 3D computer graphics[J].
Computational Materials Science, 1994, 2(2): 279-286.</a>.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>We use the <a class="reference external" href="https://docs.lammps.org/compute_cna_atom.html">same algorithm as in LAMMPS</a>.</p>
</div>
<p>CNA method is sensitive to the given cutoff distance. The suggesting cutoff can be obtained from the
following formulas:</p>
<div class="math notranslate nohighlight">
\[r_{c}^{\mathrm{fcc}} = \frac{1}{2} \left(\frac{\sqrt{2}}{2} + 1\right) a
\approx 0.8536 a,\]</div>
<div class="math notranslate nohighlight">
\[r_{c}^{\mathrm{bcc}} = \frac{1}{2}(\sqrt{2} + 1) a
\approx 1.207 a,\]</div>
<div class="math notranslate nohighlight">
\[r_{c}^{\mathrm{hcp}} = \frac{1}{2}\left(1+\sqrt{\frac{4+2x^{2}}{3}}\right) a,\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the lattice constant and <span class="math notranslate nohighlight">\(x=(c/a)/1.633\)</span> and 1.633 is the ideal ratio of <span class="math notranslate nohighlight">\(c/a\)</span>
in HCP structure.</p>
<p>The CNA method can recgonize the following structure:</p>
<ol class="arabic simple">
<li><p>Other</p></li>
<li><p>FCC</p></li>
<li><p>HCP</p></li>
<li><p>BCC</p></li>
<li><p>ICO</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em>) – cutoff distance.</p></li>
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>neighbor_number</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) neighbor atoms number.</p></li>
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box.</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>, </em><em>optional</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Defaults to [1, 1, 1].</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>pattern</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>) CNA results.</p></li>
<li><p><strong>structure</strong> (list) - the corresponding structure to each pattern.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        3.615*0.8536, max_neigh=20) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CNA</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">CommonNeighborAnalysis</span><span class="p">(</span><span class="mf">3.615</span><span class="o">*</span><span class="mf">0.8536</span><span class="p">,</span> <span class="n">neigh</span><span class="o">.</span><span class="n">verlet_list</span><span class="p">,</span> <span class="n">neigh</span><span class="o">.</span><span class="n">neighbor_number</span><span class="p">,</span>
<span class="go">            FCC.pos, FCC.box, [1, 1, 1]) # Initialize CNA class</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CNA</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the CNA per atoms</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CNA</span><span class="o">.</span><span class="n">pattern</span> <span class="c1"># Check results, should be 1 here.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CNA</span><span class="o">.</span><span class="n">structure</span><span class="p">[</span><span class="n">CNA</span><span class="o">.</span><span class="n">pattern</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="c1"># Structure of atom 0, should be fcc here.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.common_neighbor_analysis.CommonNeighborAnalysis.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/common_neighbor_analysis.html#CommonNeighborAnalysis.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.common_neighbor_analysis.CommonNeighborAnalysis.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real CNA calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.create_polycrystalline">
<span id="mdapy-create-polycrystalline-module"></span><h2>mdapy.create_polycrystalline module<a class="headerlink" href="#module-mdapy.create_polycrystalline" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Cell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.create_polycrystalline.</span></span><span class="sig-name descname"><span class="pre">Cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">face_vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cavity_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face_areas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Cell.cavity_radius">
<span class="sig-name descname"><span class="pre">cavity_radius</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Cell.cavity_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Cell.cavity_radius" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Cell.face_areas">
<span class="sig-name descname"><span class="pre">face_areas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Cell.face_areas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Cell.face_areas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Cell.face_vertices">
<span class="sig-name descname"><span class="pre">face_vertices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Cell.face_vertices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Cell.face_vertices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Cell.vertices">
<span class="sig-name descname"><span class="pre">vertices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Cell.vertices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Cell.vertices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Cell.volume">
<span class="sig-name descname"><span class="pre">volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Cell.volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Cell.volume" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Container">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.create_polycrystalline.</span></span><span class="sig-name descname"><span class="pre">Container</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Container"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Container" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.Container.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#Container.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.Container.compute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.CreatePolycrystalline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.create_polycrystalline.</span></span><span class="sig-name descname"><span class="pre">CreatePolycrystalline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seednumber</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metal_latttice_constant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metal_lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metal_overlap_dis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_graphene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gra_lattice_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metal_gra_overlap_dis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gra_overlap_dis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#CreatePolycrystalline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.CreatePolycrystalline" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to create polycrystalline structure with random grain orientation
based on the Voronoi diagram. It provides an interesting feature to replace the metallic
grain boundary into graphene, which can generate a three-dimensional graphene structure.
The metallic matrix can be FCC, BCC and HCP structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>), system box.</p></li>
<li><p><strong>seednumber</strong> (<em>int</em>) – number of initial seed to generate the Voronoi polygon.</p></li>
<li><p><strong>metal_latttice_constant</strong> (<em>float</em>) – lattice constant.</p></li>
<li><p><strong>metal_lattice_type</strong> (<em>str</em>) – metallic matrix structure type, supporting FCC, BCC and HCP.</p></li>
<li><p><strong>randomseed</strong> (<em>int</em><em>, </em><em>optional</em>) – randomseed to generate the random number, this is helpful to reproduce the same structure. If not given, a random seed will be generated.</p></li>
<li><p><strong>metal_overlap_dis</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum distance between metallic particles. If not given, this parameter will be determined by the given metal_lattice_type and metal_latttice_constant.</p></li>
<li><p><strong>add_graphene</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether use graphene as grain boundary. Defaults to False.</p></li>
<li><p><strong>gra_lattice_constant</strong> (<em>float</em><em>, </em><em>optional</em>) – C-C bond length in graphene. Defaults to 1.42.</p></li>
<li><p><strong>metal_gra_overlap_dis</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum distance between metallic particles and graphene. Defaults to 3.1.</p></li>
<li><p><strong>gra_overlap_dis</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum distance between atoms in graphene. Defaults to 1.2.</p></li>
<li><p><strong>seed</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (seednumber, 3) initial position of seed to generate Voronoi polygon. If not given, it will be generated by the given randomseed.</p></li>
<li><p><strong>if_rotation</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether rotate the grain orientation. Defaults to True.</p></li>
<li><p><strong>theta_list</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (seednumber, 3) rotation degree of each grain along x, y, z axis. If not given, it will be generated by the given randomseed.</p></li>
<li><p><strong>face_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum voronoi polygon face area to add graphene. Defaults to 5.0.</p></li>
<li><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of DUMP file. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>generate an polycrystalline DUMP file with grain ID.</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">box</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">]])</span> <span class="c1"># Generate a box.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polycry</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">CreatePolycrystalline</span><span class="p">(</span>
<span class="go">              box, 20, 3.615, &quot;FCC&quot;, add_graphene=True) # Initilize a Poly class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polycry</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Generate a graphene/metal structure with 20 grains.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.create_polycrystalline.CreatePolycrystalline.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/create_polycrystalline.html#CreatePolycrystalline.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.create_polycrystalline.CreatePolycrystalline.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real polycrystalline structure building.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.eam_average">
<span id="mdapy-eam-average-module"></span><h2>mdapy.eam_average module<a class="headerlink" href="#module-mdapy.eam_average" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.eam_average.EAMAverage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.eam_average.</span></span><span class="sig-name descname"><span class="pre">EAMAverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/eam_average.html#EAMAverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.eam_average.EAMAverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mdapy.potential.EAM" title="mdapy.potential.EAM"><code class="xref py py-class docutils literal notranslate"><span class="pre">EAM</span></code></a></p>
<p>This class is used to generate the average EAM (A-atom) potential, which is useful in alloy investigation.
The A-atom potential has the similar formula with the original EAM potential:</p>
<div class="math notranslate nohighlight">
\[E_{i}=\sum_{i} F^{A}\left(\bar{\rho}_{i}\right)+\frac{1}{2} \sum_{i, j \neq i} \phi_{i j}^{A A},\]</div>
<div class="math notranslate nohighlight">
\[F^{A}\left(\bar{\rho}_{i}\right)=\sum_{\alpha} c_{\alpha} F^{\alpha}\left(\bar{\rho}_{i}\right),\]</div>
<div class="math notranslate nohighlight">
\[\phi_{i j}^{A A}=\sum_{\alpha, \beta } c_{\alpha} c_{\beta} \phi_{i j}^{\alpha \beta},\]</div>
<div class="math notranslate nohighlight">
\[\quad \bar{\rho}_{i}=\sum_{j \neq i} \sum_{\alpha} c_{\alpha} \rho_{i j}^{\alpha},\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> denotes an average-atom.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this module in publication, you should also cite the original paper.
<a class="reference external" href="https://doi.org/10.1103/PhysRevB.93.104201">Average-atom interatomic potential for random alloys</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename of eam.alloy file.</p></li>
<li><p><strong>concentration</strong> (<em>list</em>) – atomic ratio list, such as [0.5, 0.5] and the summation should be equal to 1.</p></li>
<li><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated average EAM potential.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>generate an averaged eam.alloy potential file with A element.</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">EAMAverage</span><span class="p">(</span><span class="s2">&quot;./example/CoNiFeAlCu.eam.alloy&quot;</span><span class="p">,</span>
<span class="go">                [0.2, 0.2, 0.2, 0.2, 0.2]) # Generate the EAMAverage class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># plot the results.</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-mdapy.eam_generate">
<span id="mdapy-eam-generate-module"></span><h2>mdapy.eam_generate module<a class="headerlink" href="#module-mdapy.eam_generate" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.eam_generate.EAMGenerate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.eam_generate.</span></span><span class="sig-name descname"><span class="pre">EAMGenerate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/eam_generate.html#EAMGenerate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.eam_generate.EAMGenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to create EAM potential including one or more elements.
This is the python version translated from the <a class="reference external" href="https://www.ctcms.nist.gov/potentials/entry/2004--Zhou-X-W-Johnson-R-A-Wadley-H-N-G--W/">fortran version by Zhou et. al</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this module in publication, you should also cite the original paper.
<a class="reference external" href="https://doi.org/10.1103/PhysRevB.69.144113">Misfit-energy-increasing dislocations in vapor-deposited CoFe/NiFe multilayers</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements_list</strong> (<em>list</em>) – elements list, such as [‘Co’, ‘Ni’], wchich should choose from [“Cu”,”Ag”,”Au”,”Ni”,”Pd”,”Pt”,”Al”,”Pb”,”Fe”,”Mo”,”Ta”,”W”,”Mg”,”Co”,”Ti”,”Zr”].</p></li>
<li><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated EAM file.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>generate an eam.alloy potential file.</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">EAMGenerate</span><span class="p">([</span><span class="s2">&quot;Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;Fe&quot;</span><span class="p">])</span> <span class="c1"># Generate the EAMGenerate class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># plot the results.</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-mdapy.entropy">
<span id="mdapy-entropy-module"></span><h2>mdapy.entropy module<a class="headerlink" href="#module-mdapy.entropy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.entropy.AtomicEntropy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.entropy.</span></span><span class="sig-name descname"><span class="pre">AtomicEntropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/entropy.html#AtomicEntropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.entropy.AtomicEntropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the entropy fingerprint, which is useful to distinguish
between ordered and disordered environments, including liquid and solid-like environments,
or glassy and crystalline-like environments. The potential application could identificate grain boundaries
or a solid cluster emerging from the melt. One of the advantages of this parameter is that no a priori
information of structure is required.</p>
<p>This parameter for atom <span class="math notranslate nohighlight">\(i\)</span> is computed using the following formula:</p>
<div class="math notranslate nohighlight">
\[s_S^i=-2\pi\rho k_B \int\limits_0^{r_m} \left [ g(r) \ln g(r) - g(r) + 1 \right ] r^2 dr,\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is a distance, <span class="math notranslate nohighlight">\(g(r)\)</span> is the radial distribution function,
and <span class="math notranslate nohighlight">\(\rho\)</span> is the density of the system.
The <span class="math notranslate nohighlight">\(g(r)\)</span> computed for each atom <span class="math notranslate nohighlight">\(i\)</span> can be noisy and therefore it can be smoothed using:</p>
<div class="math notranslate nohighlight">
\[g_m^i(r) = \frac{1}{4 \pi \rho r^2} \sum\limits_{j} \frac{1}{\sqrt{2 \pi \sigma^2}} e^{-(r-r_{ij})^2/(2\sigma^2)},\]</div>
<p>where the sum over <span class="math notranslate nohighlight">\(j\)</span> goes through the neighbors of atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> is
a parameter to control the smoothing. The average of the parameter over the neighbors of atom <span class="math notranslate nohighlight">\(i\)</span>
is calculated according to:</p>
<div class="math notranslate nohighlight">
\[\left&lt; s_S^i \right&gt;  = \frac{\sum_j s_S^j + s_S^i}{N + 1},\]</div>
<p>where the sum over <span class="math notranslate nohighlight">\(j\)</span> goes over the neighbors of atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(N\)</span> is the number of neighbors.
The average version always provides a sharper distinction between order and disorder environments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this module in publication, you should also cite the original paper.
<a class="reference external" href="https://doi.org/10.1063/1.4998408">Entropy based fingerprint for local crystalline order</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class uses the <a class="reference external" href="https://docs.lammps.org/compute_entropy_atom.html">same algorithm with LAMMPS</a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Suggestions for FCC, the <span class="math notranslate nohighlight">\(rc = 1.4a\)</span> and <span class="math notranslate nohighlight">\(average\_rc = 0.9a\)</span> and
for BCC, the <span class="math notranslate nohighlight">\(rc = 1.8a\)</span> and <span class="math notranslate nohighlight">\(average\_rc = 1.2a\)</span>, where the <span class="math notranslate nohighlight">\(a\)</span>
is the lattice constant.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vol</strong> (<em>float</em>) – system volume.</p></li>
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 5.0.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – smoothing parameter. Defaults to 0.2.</p></li>
<li><p><strong>use_local_density</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether use local atomic volume. Defaults to False.</p></li>
<li><p><strong>compute_average</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether compute the average version. Defaults to False.</p></li>
<li><p><strong>average_rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance for averaging operation, if not given, it is equal to rc. This parameter should be lower than rc.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>entropy</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>), atomic entropy.</p></li>
<li><p><strong>entropy_average</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>), averaged atomic entropy if compute_average is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        3.615*1.4, max_neigh=80) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="c1"># Calculate system volume.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entropy</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">AtomicEntropy</span><span class="p">(</span>
<span class="go">        vol,</span>
<span class="go">        neigh.verlet_list,</span>
<span class="go">        neigh.distance_list,</span>
<span class="go">        neigh.rc,</span>
<span class="go">        sigma=0.2,</span>
<span class="go">        use_local_density=False,</span>
<span class="go">        compute_average=True,</span>
<span class="go">        average_rc=3.615*0.9,</span>
<span class="go">    ) # Initilize the entropy class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entropy</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the atomic entropy.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entropy</span><span class="o">.</span><span class="n">entropy</span> <span class="c1"># Check atomic entropy.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entropy</span><span class="o">.</span><span class="n">entropy_average</span> <span class="c1"># Check averaged atomic entropy.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.entropy.AtomicEntropy.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/entropy.html#AtomicEntropy.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.entropy.AtomicEntropy.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real entropy calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.kdtree">
<span id="mdapy-kdtree-module"></span><h2>mdapy.kdtree module<a class="headerlink" href="#module-mdapy.kdtree" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.kdtree.kdtree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.kdtree.</span></span><span class="sig-name descname"><span class="pre">kdtree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/kdtree.html#kdtree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.kdtree.kdtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is a wrapper of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.KDTree.html">kdtree of scipy</a>
and helful to obtain the certain nearest atom neighbors considering the periodic/free boundary.
If you want to access the atom neighbor within a spherical
distance, the Neighbor class is suggested.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>), particles positions.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>), system box.</p></li>
<li><p><strong>boundary</strong> (<em>list</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Such as [1, 1, 1].</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>shift_pos</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, 3\)</span>), shifted position, making the lower cornor is zero.</p></li>
<li><p><strong>kdt</strong> (scipy.spatial.KDTree) - a KDTree class.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kdt</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">kdtree</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># Build a kdtree.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dis</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">kdt</span><span class="o">.</span><span class="n">query_nearest_neighbors</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># Query the 12 nearest neighbors per atom.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.kdtree.kdtree.query_nearest_neighbors">
<span class="sig-name descname"><span class="pre">query_nearest_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/kdtree.html#kdtree.query_nearest_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.kdtree.kdtree.query_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the <span class="math notranslate nohighlight">\(n\)</span> nearest atom neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – number of neighbors to query.</p></li>
<li><p><strong>workers</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum CPU cores to use in calculation. Defaults to -1, indicating using all available CPU cores.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(distance, index), distance of atom <span class="math notranslate nohighlight">\(i\)</span> to its neighbor atom <span class="math notranslate nohighlight">\(j\)</span>, and the index of atom <span class="math notranslate nohighlight">\(j\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.lattice_maker">
<span id="mdapy-lattice-maker-module"></span><h2>mdapy.lattice_maker module<a class="headerlink" href="#module-mdapy.lattice_maker" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.lattice_maker.LatticeMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.lattice_maker.</span></span><span class="sig-name descname"><span class="pre">LatticeMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_constant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/lattice_maker.html#LatticeMaker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.lattice_maker.LatticeMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to create some standard lattice structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice_constant</strong> (<em>float</em>) – lattice constant <span class="math notranslate nohighlight">\(a\)</span>.</p></li>
<li><p><strong>lattice_type</strong> (<em>str</em>) – lattice type, seleted in [‘FCC’, ‘BCC’, ‘HCP’, ‘GRA’]. Here the HCP is ideal structure and the <span class="math notranslate nohighlight">\(c/a=1.633\)</span>.</p></li>
<li><p><strong>x</strong> (<em>int</em>) – repeat times along <span class="math notranslate nohighlight">\(x\)</span> axis.</p></li>
<li><p><strong>y</strong> (<em>int</em>) – repeat times along <span class="math notranslate nohighlight">\(y\)</span> axis.</p></li>
<li><p><strong>z</strong> (<em>int</em>) – repeat times along <span class="math notranslate nohighlight">\(z\)</span> axis.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>box</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(3, 2\)</span>), system box.</p></li>
<li><p><strong>pos</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, 3\)</span>), particle position.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">write_data</span><span class="p">()</span> <span class="c1"># Save to DATA file.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GRA</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">1.42</span><span class="p">,</span> <span class="s1">&#39;GRA&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Create a graphene structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GRA</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="s1">&#39;graphene.data&#39;</span><span class="p">)</span> <span class="c1"># Save to graphene.data file.</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mdapy.lattice_maker.LatticeMaker.N">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">N</span></span><a class="headerlink" href="#mdapy.lattice_maker.LatticeMaker.N" title="Permalink to this definition">¶</a></dt>
<dd><p>The particle number.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.lattice_maker.LatticeMaker.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/lattice_maker.html#LatticeMaker.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.lattice_maker.LatticeMaker.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real lattice calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.lattice_maker.LatticeMaker.write_data">
<span class="sig-name descname"><span class="pre">write_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/lattice_maker.html#LatticeMaker.write_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.lattice_maker.LatticeMaker.write_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function writes position into a DATA file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type_list</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) atom type list. If not given, the atom type is set as 1.</p></li>
<li><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated DATA file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.lindemann_parameter">
<span id="mdapy-lindemann-parameter-module"></span><h2>mdapy.lindemann_parameter module<a class="headerlink" href="#module-mdapy.lindemann_parameter" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.lindemann_parameter.LindemannParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.lindemann_parameter.</span></span><span class="sig-name descname"><span class="pre">LindemannParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_global</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/lindemann_parameter.html#LindemannParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.lindemann_parameter.LindemannParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the <a class="reference external" href="https://en.wikipedia.org/wiki/Lindemann_index">Lindemann index</a>,
which is useful to distinguish the melt process and determine the melting points of nano-particles.
The Lindemann index is defined as the root-mean-square bond-length fluctuation with following mathematical expression:</p>
<div class="math notranslate nohighlight">
\[\left\langle\sigma_{i}\right\rangle=\frac{1}{N_{p}(N_{p}-1)} \sum_{j \neq i} \frac{\sqrt{\left\langle r_{i j}^{2}\right\rangle_t-\left\langle r_{i j}\right\rangle_t^{2}}}{\left\langle r_{i j}\right\rangle_t},\]</div>
<p>where <span class="math notranslate nohighlight">\(N_p\)</span> is the particle number, <span class="math notranslate nohighlight">\(r_{ij}\)</span> is the distance between atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> and brackets <span class="math notranslate nohighlight">\(\left\langle \right\rangle_t\)</span>
represents an time average.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is partly referred to a <a class="reference external" href="https://github.com/N720720/lindemann">work</a> on calculating the Lindemann index.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This calculation is high memory requirement. One can estimate the memory by: <span class="math notranslate nohighlight">\(2 * 8 * N_p^2 / 1024^3\)</span> GB.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If only global lindemann index is needed, the class can be calculated in parallel.
The local Lindemann index only run serially due to the dependencies between different frames.
Here we use the <a class="reference external" href="https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Welford">Welford method</a> to
update the varience and mean of <span class="math notranslate nohighlight">\(r_{ij}\)</span>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_f, N_p, 3\)</span>), <span class="math notranslate nohighlight">\(N_f\)</span> frames particle position, which need to be unwrapped for periodic boundary.</p></li>
<li><p><strong>only_global</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether only calculate the global index. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>lindemann_atom</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_f, N_p\)</span>), local Lindemann index per atoms.</p></li>
<li><p><strong>lindemann_frame</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_f\)</span>), Lindemann index per frames.</p></li>
<li><p><strong>lindemann_trj</strong> (float) - global Lindemann index for an entire trajectory.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span>
<span class="go">    np.random.choice([-1.0, 0.0, 1.0], size=(200, 1000, 3)), axis=0</span>
<span class="go">    ) # Generate a random walk trajectory with 200 frames and 1000 particles.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LDMG</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LindemannParameter</span><span class="p">(</span><span class="n">pos_list</span><span class="p">,</span> <span class="n">only_global</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Generate a Lindemann class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LDMG</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Only calculate the global Lindemann index, it will be much faster.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LDML</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LindemannParameter</span><span class="p">(</span><span class="n">pos_list</span><span class="p">)</span> <span class="c1"># Generate a Lindemann class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LDML</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the global and local Lindemann index.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">LDML</span><span class="o">.</span><span class="n">lindemann_trj</span><span class="p">,</span> <span class="n">LDMG</span><span class="o">.</span><span class="n">lindemann_trj</span><span class="p">)</span> <span class="c1"># Should return True.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LDML</span><span class="o">.</span><span class="n">lindemann_frame</span> <span class="c1"># Check Lindemann index per frame.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LDML</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot the evolution of Lindemann index per frame.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.lindemann_parameter.LindemannParameter.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/lindemann_parameter.html#LindemannParameter.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.lindemann_parameter.LindemannParameter.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real Lindemann index calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.lindemann_parameter.LindemannParameter.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/lindemann_parameter.html#LindemannParameter.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.lindemann_parameter.LindemannParameter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the evolution of Lindemann index per frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Exception</strong> – One should compute lidemann_frame first!</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.mean_squared_displacement">
<span id="mdapy-mean-squared-displacement-module"></span><h2>mdapy.mean_squared_displacement module<a class="headerlink" href="#module-mdapy.mean_squared_displacement" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.mean_squared_displacement.MeanSquaredDisplacement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.mean_squared_displacement.</span></span><span class="sig-name descname"><span class="pre">MeanSquaredDisplacement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'windows'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/mean_squared_displacement.html#MeanSquaredDisplacement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.mean_squared_displacement.MeanSquaredDisplacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the mean squared displacement MSD of system, which can be used to
reflect the particle diffusion trend and describe the melting process. Generally speaking, MSD is an
average displacement over all windows of length <span class="math notranslate nohighlight">\(m\)</span> over the course of the simulation (so-called
‘windows’ mode here) and defined
by:</p>
<div class="math notranslate nohighlight">
\[MSD(m) = \frac{1}{N_{p}} \sum_{i=1}^{N_{p}} \frac{1}{N_{f}-m} \sum_{k=0}^{N_{f}-m-1} (\vec{r}_i(k+m) - \vec{r}_i(k))^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(r_i(t)\)</span> is the position of particle <span class="math notranslate nohighlight">\(i\)</span> in frame <span class="math notranslate nohighlight">\(t\)</span>. It is computationally extensive
while using a fast Fourier transform can remarkably reduce the computation cost as described in <a class="reference external" href="https://doi.org/10.1051/sfn/201112010">nMoldyn - Interfacing
spectroscopic experiments, molecular dynamics simulations and models for time correlation functions</a> and discussion in <a class="reference external" href="https://stackoverflow.com/questions/34222272/computing-mean-square-displacement-using-python-and-fft">StackOverflow</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One can install <a class="reference external" href="https://github.com/pyFFTW/pyFFTW">pyfftw</a> to accelerate the calculation,
otherwise mdapy will use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft">scipy.fft</a>
to do the Fourier transform.</p>
</div>
<p>Sometimes one only need the following atomic displacement (so-called ‘direct’ mode here):</p>
<div class="math notranslate nohighlight">
\[MSD(t) = \dfrac{1}{N_p} \sum_{i=1}^{N_p} (r_i(t) - r_i(0))^2.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_f, N_p, 3\)</span>), <span class="math notranslate nohighlight">\(N_f\)</span> frames particle position, which need to be unwrapped for periodic boundary.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – calculation mode, selected from [‘windows’, ‘direct’]. Defaults to “windows”.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>msd</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_f\)</span>), mean squared displacement per frames.</p></li>
<li><p><strong>particle_msd</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_f, N_p\)</span>), mean squared displacement per atom per frames.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span>
<span class="go">    np.random.choice([-1.0, 0.0, 1.0], size=(200, 1000, 3)), axis=0</span>
<span class="go">    ) # Generate a random walk trajectory with 200 frames and 1000 particles.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MSD</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MeanSquaredDisplacement</span><span class="p">(</span><span class="n">pos_list</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;windows&quot;</span><span class="p">)</span> <span class="c1"># Initilize MSD class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MSD</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the MSD in &#39;windows&#39; mode.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MSD</span><span class="o">.</span><span class="n">msd</span> <span class="c1"># Check msd.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MSD</span><span class="o">.</span><span class="n">particle_msd</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># Check msd per particle, should be (200, 1000) here.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MSD</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot the evolution of msd per frame.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.mean_squared_displacement.MeanSquaredDisplacement.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/mean_squared_displacement.html#MeanSquaredDisplacement.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.mean_squared_displacement.MeanSquaredDisplacement.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real MSD calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.mean_squared_displacement.MeanSquaredDisplacement.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/mean_squared_displacement.html#MeanSquaredDisplacement.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.mean_squared_displacement.MeanSquaredDisplacement.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the evolution of MSD per frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdapy.mean_squared_displacement.fft">
<span class="sig-prename descclassname"><span class="pre">mdapy.mean_squared_displacement.</span></span><span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/mean_squared_displacement.html#fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.mean_squared_displacement.fft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdapy.mean_squared_displacement.ifft">
<span class="sig-prename descclassname"><span class="pre">mdapy.mean_squared_displacement.</span></span><span class="sig-name descname"><span class="pre">ifft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/mean_squared_displacement.html#ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.mean_squared_displacement.ifft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-mdapy.neighbor">
<span id="mdapy-neighbor-module"></span><h2>mdapy.neighbor module<a class="headerlink" href="#module-mdapy.neighbor" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.neighbor.Neighbor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.neighbor.</span></span><span class="sig-name descname"><span class="pre">Neighbor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/neighbor.html#Neighbor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.neighbor.Neighbor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This module is used to cerate neighbor of atoms within a given cutoff distance.
Using linked-cell list method makes fast neighbor finding possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box, must be rectangle.</p></li>
<li><p><strong>rc</strong> (<em>float</em>) – cutoff distance.</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>, </em><em>optional</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Defaults to [1, 1, 1].</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – a given maximum neighbor number per atoms. Defaults to 80.</p></li>
<li><p><strong>exclude</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether include atom self, True means no including. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>verlet_list</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
<li><p><strong>neighbor_number</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>) neighbor atoms number.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        5., max_neigh=80) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">verlet_list</span> <span class="c1"># Check the neighbor index.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">distance_list</span> <span class="c1"># Check the neighbor distance.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">neighbor_number</span> <span class="c1"># Check the neighbor atom number.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.neighbor.Neighbor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/neighbor.html#Neighbor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.neighbor.Neighbor.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real neighbor calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.pair_distribution">
<span id="mdapy-pair-distribution-module"></span><h2>mdapy.pair_distribution module<a class="headerlink" href="#module-mdapy.pair_distribution" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.pair_distribution.PairDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.pair_distribution.</span></span><span class="sig-name descname"><span class="pre">PairDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/pair_distribution.html#PairDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.pair_distribution.PairDistribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the radiul distribution function (RDF),which
reflects the probability of finding an atom at distance r. The seperate pair-wise
combinations of particle types can also be computed:</p>
<div class="math notranslate nohighlight">
\[g(r) = c_{\alpha}^2 g_{\alpha \alpha}(r) + 2 c_{\alpha} c_{\beta} g_{\alpha \beta}(r) + c_{\beta}^2 g_{\beta \beta}(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{\alpha}\)</span> and <span class="math notranslate nohighlight">\(c_{\beta}\)</span> denote the concentration of two atom types in system
and <span class="math notranslate nohighlight">\(g_{\alpha \beta}(r)=g_{\beta \alpha}(r)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em>) – cutoff distance.</p></li>
<li><p><strong>nbin</strong> (<em>int</em>) – number of bins.</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – system density.</p></li>
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
<li><p><strong>type_list</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) atom type list. If not given, all atoms types are set as 1.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>r</strong> (np.ndarray) - (nbin), distance.</p></li>
<li><p><strong>g_total</strong> (np.ndarray) - (nbin), global RDF.</p></li>
<li><p><strong>Ntype</strong> (int) - number of species.</p></li>
<li><p><strong>g</strong> (np.ndarray): (<span class="math notranslate nohighlight">\(N_{type}, N_{type}, nbin\)</span>), partial RDF.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        5., max_neigh=80) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span> <span class="o">=</span> <span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="c1"># Get the system density.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">PairDistribution</span><span class="p">(</span><span class="n">neigh</span><span class="o">.</span><span class="n">rc</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span>
<span class="go">                          neigh.verlet_list, neigh.distance_list,</span>
<span class="go">                          np.ones(FCC.N, dtype=int)) # Initilize the RDF class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the RDF.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span><span class="o">.</span><span class="n">g_total</span> <span class="c1"># Check global RDF.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span><span class="o">.</span><span class="n">g</span> <span class="c1"># Check partial RDF, here is the same due to only one species.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span><span class="o">.</span><span class="n">r</span> <span class="c1"># Check the distance.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot global RDF.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span><span class="o">.</span><span class="n">plot_partial</span><span class="p">()</span> <span class="c1"># Plot partial RDF.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.pair_distribution.PairDistribution.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/pair_distribution.html#PairDistribution.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.pair_distribution.PairDistribution.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real RDF calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.pair_distribution.PairDistribution.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/pair_distribution.html#PairDistribution.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.pair_distribution.PairDistribution.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the global RDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.pair_distribution.PairDistribution.plot_partial">
<span class="sig-name descname"><span class="pre">plot_partial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/pair_distribution.html#PairDistribution.plot_partial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.pair_distribution.PairDistribution.plot_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the partial RDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>elements_list</strong> (<em>list</em><em>, </em><em>optional</em>) – species element names list, such as [‘Al’, ‘Ni’].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.plotset">
<span id="mdapy-plotset-module"></span><h2>mdapy.plotset module<a class="headerlink" href="#module-mdapy.plotset" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mdapy.plotset.cm2inch">
<span class="sig-prename descclassname"><span class="pre">mdapy.plotset.</span></span><span class="sig-name descname"><span class="pre">cm2inch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/plotset.html#cm2inch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.plotset.cm2inch" title="Permalink to this definition">¶</a></dt>
<dd><p>Centimeters to feet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> (<em>float</em>) – centimeters.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>feet.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdapy.plotset.pltset">
<span class="sig-prename descclassname"><span class="pre">mdapy.plotset.</span></span><span class="sig-name descname"><span class="pre">pltset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ticksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legendsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axeswidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickdirection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'in'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mtickvisible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontkind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Times</span> <span class="pre">New</span> <span class="pre">Roman'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontweight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/plotset.html#pltset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.plotset.pltset" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a drawing template function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ticksize</strong> (<em>int</em><em>, </em><em>optional</em>) – axis ticklabel fontsize. Defaults to 12.</p></li>
<li><p><strong>labelsize</strong> (<em>int</em><em>, </em><em>optional</em>) – label fontsize. Defaults to 12.</p></li>
<li><p><strong>legendsize</strong> (<em>int</em><em>, </em><em>optional</em>) – legend fontsize. Defaults to 12.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – width of line. Defaults to 1.5.</p></li>
<li><p><strong>axeswidth</strong> (<em>int</em><em>, </em><em>optional</em>) – width of axis line. Defaults to 1.</p></li>
<li><p><strong>tickwidth</strong> (<em>int</em><em>, </em><em>optional</em>) – width of axis tick. Defaults to 1.</p></li>
<li><p><strong>ticklength</strong> (<em>int</em><em>, </em><em>optional</em>) – length of axis tick. Defaults to 3.</p></li>
<li><p><strong>tickdirection</strong> (<em>str</em><em>, </em><em>optional</em>) – axis tick direction. Defaults to “in”.</p></li>
<li><p><strong>mtickvisible</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether show minor axis tick. Defaults to False.</p></li>
<li><p><strong>fontkind</strong> (<em>str</em><em>, </em><em>optional</em>) – font family. Defaults to “Times New Roman”.</p></li>
<li><p><strong>fontweight</strong> (<em>bool</em><em>, </em><em>optional</em>) – bold font or not. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mdapy.potential">
<span id="mdapy-potential-module"></span><h2>mdapy.potential module<a class="headerlink" href="#module-mdapy.potential" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.potential.EAM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.potential.</span></span><span class="sig-name descname"><span class="pre">EAM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/potential.html#EAM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.potential.EAM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to read/write a embedded-atom method (EAM) potentials.
The energy of atom <span class="math notranslate nohighlight">\(i\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[E_i = F_\alpha \left(\sum_{j \neq i}\rho_\beta (r_{ij})\right) + \frac{1}{2} \sum_{j \neq i} \phi_{\alpha\beta} (r_{ij}),\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the embedding energy, <span class="math notranslate nohighlight">\(\rho\)</span> is the electron density, <span class="math notranslate nohighlight">\(\phi\)</span> is the pair interaction, and <span class="math notranslate nohighlight">\(\alpha\)</span> and
<span class="math notranslate nohighlight">\(\beta\)</span> are the elements species of atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>. Both summation go over all neighbor atom <span class="math notranslate nohighlight">\(j\)</span> of atom
<span class="math notranslate nohighlight">\(i\)</span> withing the cutoff distance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only support <a class="reference external" href="https://docs.lammps.org/pair_eam.html">eam.alloy</a> definded in LAMMPS format now.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename of eam.alloy file.</p>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>Nelements</strong> (int) - number of elements.</p></li>
<li><p><strong>elements_list</strong> (list) - elements list.</p></li>
<li><p><strong>nrho</strong> (int) - number of <span class="math notranslate nohighlight">\(\rho\)</span> array.</p></li>
<li><p><strong>nr</strong> (int) - number of <span class="math notranslate nohighlight">\(r\)</span> array.</p></li>
<li><p><strong>drho</strong> (float) - spacing of electron density <span class="math notranslate nohighlight">\(\rho\)</span> space.</p></li>
<li><p><strong>dr</strong> (float) - spacing of real distance <span class="math notranslate nohighlight">\(r\)</span> space. Unit is Angstroms.</p></li>
<li><p><strong>rc</strong> (float) - cutoff distance. Unit is Angstroms.</p></li>
<li><p><strong>r</strong> (np.ndarray) - (nr), distance space.</p></li>
<li><p><strong>rho</strong> (np.ndarray) - (nrho), electron density space.</p></li>
<li><p><strong>aindex</strong> (np.ndarray) - (Nelements), element serial number.</p></li>
<li><p><strong>amass</strong> (np.ndarray) - (Nelements), element mass.</p></li>
<li><p><strong>lattice_constant</strong> (np.ndarray) - (Nelements), lattice constant. Unit is Angstroms.</p></li>
<li><p><strong>lattice_type</strong> (list) - (Nelements), lattice type, such as [fcc, bcc].</p></li>
<li><p><strong>embedded_data</strong> (np.ndarray) - (Nelements, nrho), embedded energy <span class="math notranslate nohighlight">\(F\)</span>.</p></li>
<li><p><strong>elec_density_data</strong> (np.ndarray) - (Nelements, nr), electron density <span class="math notranslate nohighlight">\(\rho\)</span>.</p></li>
<li><p><strong>rphi_data</strong> (np.ndarray) = (Nelements, Nelements, nr), <span class="math notranslate nohighlight">\(r*\phi\)</span>.</p></li>
<li><p><strong>d_embedded_data</strong> (np.ndarray) - (Nelements, nrho), derivatives of embedded energy <span class="math notranslate nohighlight">\(dF/d\rho\)</span>.</p></li>
<li><p><strong>d_elec_density_data</strong> (np.ndarray) - (Nelements, nr), derivatives of electron density <span class="math notranslate nohighlight">\(d\rho/dr\)</span>.</p></li>
<li><p><strong>phi_data</strong> (np.ndarray) = (Nelements, Nelements, nr), pair interaction <span class="math notranslate nohighlight">\(\phi\)</span>.</p></li>
<li><p><strong>d_phi_data</strong> (np.ndarray) = (Nelements, Nelements, nr), derivatives of pair interaction <span class="math notranslate nohighlight">\(d\phi/dr\)</span>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span> <span class="o">=</span> <span class="n">EAM</span><span class="p">(</span><span class="s2">&quot;./example/CoNiFeAlCu.eam.alloy&quot;</span><span class="p">)</span> <span class="c1"># Read a eam.alloy file.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span><span class="o">.</span><span class="n">embedded_data</span> <span class="c1"># Check embedded energy.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span><span class="o">.</span><span class="n">phi_data</span> <span class="c1"># Check pair interaction.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">potential</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot information of potential.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.potential.EAM.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/potential.html#EAM.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.potential.EAM.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span>, <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.potential.EAM.plot_embded_rho">
<span class="sig-name descname"><span class="pre">plot_embded_rho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/potential.html#EAM.plot_embded_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.potential.EAM.plot_embded_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the <span class="math notranslate nohighlight">\(F\)</span> with <span class="math notranslate nohighlight">\(\rho\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.potential.EAM.plot_phi_r">
<span class="sig-name descname"><span class="pre">plot_phi_r</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/potential.html#EAM.plot_phi_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.potential.EAM.plot_phi_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the <span class="math notranslate nohighlight">\(\phi\)</span> with <span class="math notranslate nohighlight">\(r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.potential.EAM.plot_rho_r">
<span class="sig-name descname"><span class="pre">plot_rho_r</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/potential.html#EAM.plot_rho_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.potential.EAM.plot_rho_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the <span class="math notranslate nohighlight">\(\rho\)</span> with <span class="math notranslate nohighlight">\(r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.potential.EAM.write_eam_alloy">
<span class="sig-name descname"><span class="pre">write_eam_alloy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/potential.html#EAM.write_eam_alloy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.potential.EAM.write_eam_alloy" title="Permalink to this definition">¶</a></dt>
<dd><p>Save to a eam.alloy file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated eam file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.spatial_binning">
<span id="mdapy-spatial-binning-module"></span><h2>mdapy.spatial_binning module<a class="headerlink" href="#module-mdapy.spatial_binning" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.spatial_binning.SpatialBinning">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.spatial_binning.</span></span><span class="sig-name descname"><span class="pre">SpatialBinning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/spatial_binning.html#SpatialBinning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.spatial_binning.SpatialBinning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to divide particles into different bins and operating on each bin.
One-dimensional to Three-dimensional binning are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – binning direction, selected in [‘x’, ‘y’, ‘z’, ‘xy’, ‘xz’, ‘yz’, ‘xyz’]</p></li>
<li><p><strong>vbin</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, x\)</span>), values to be operated, <span class="math notranslate nohighlight">\(x\)</span> means arbitrary columns.</p></li>
<li><p><strong>wbin</strong> (<em>float</em><em>, </em><em>optional</em>) – width of each bin. Defaults to 5.0.</p></li>
<li><p><strong>operation</strong> (<em>str</em><em>, </em><em>optional</em>) – operation on each bin, selected from [‘mean’, ‘sum’, ‘min’, ‘max’]. Defaults to “mean”.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>res</strong> (np.ndarray) - binning results, res[:, …, 0] is the number of atoms each bin.</p></li>
<li><p><strong>coor</strong> (dict) - coordination along binning direction, such as coor[‘x’].</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">4.05</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="c1"># Create a FCC structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binning</span> <span class="o">=</span> <span class="n">SpatialBinning</span><span class="p">(</span>
<span class="go">        FCC.pos,</span>
<span class="go">        &quot;xz&quot;,</span>
<span class="go">        FCC.pos[:, 0],</span>
<span class="go">        operation=&quot;mean&quot;,</span>
<span class="go">    ) # Initilize the binning class along &#39;xz&#39; plane.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binning</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Do the binnning calculation.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binning</span><span class="o">.</span><span class="n">res</span> <span class="c1"># Check the binning results.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binning</span><span class="o">.</span><span class="n">coor</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="c1"># Check the x coordination.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binning</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bar_label</span><span class="o">=</span><span class="s1">&#39;x coordination&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.spatial_binning.SpatialBinning.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/spatial_binning.html#SpatialBinning.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.spatial_binning.SpatialBinning.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real binning calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.spatial_binning.SpatialBinning.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/spatial_binning.html#SpatialBinning.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.spatial_binning.SpatialBinning.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the binning results for One- and Two-dimensional binning.
For 2-D binning, only the first column value will be plotted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_list</strong> (<em>list</em><em>, </em><em>optional</em>) – value name. Defaults to None.</p></li>
<li><p><strong>bar_label</strong> (<em>str</em><em>, </em><em>optional</em>) – colorbar label for Two-dimensional binning. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – “Three-dimensional binning visualization is not supported yet!”</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.system">
<span id="mdapy-system-module"></span><h2>mdapy.system module<a class="headerlink" href="#module-mdapy.system" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.system.MultiSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.system.</span></span><span class="sig-name descname"><span class="pre">MultiSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unwrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#MultiSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.MultiSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>This class is a collection of mdapy.System class and is helful to handle the atomic trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename_list</strong> (<em>list</em>) – ordered filename list, such as [‘melt.0.dump’, ‘melt.100.dump’].</p></li>
<li><p><strong>unwrap</strong> (<em>bool</em><em>, </em><em>optional</em>) – make atom positions do not wrap into box due to periotic boundary. Defaults to True.</p></li>
<li><p><strong>sorted_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – sort data by atoms id. Defaults to True.</p></li>
<li><p><strong>image_p</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>), image_p help to unwrap positions, if don’t provided, using minimum image criterion, see <a class="reference external" href="https://en.wikipedia.org/wiki/Periodic_boundary_conditions#Practical_implementation:_continuity_and_the_minimum_image_convention">https://en.wikipedia.org/wiki/Periodic_boundary_conditions#Practical_implementation:_continuity_and_the_minimum_image_convention</a>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>pos_list</strong> (np.ndarray): (<span class="math notranslate nohighlight">\(N_f, N_p, 3\)</span>), <span class="math notranslate nohighlight">\(N_f\)</span> frames particle position.</p></li>
<li><p><strong>Nframes</strong> (int): number of frames.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.MultiSystem.cal_lindemann_parameter">
<span class="sig-name descname"><span class="pre">cal_lindemann_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">only_global</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#MultiSystem.cal_lindemann_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.MultiSystem.cal_lindemann_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <a class="reference external" href="https://en.wikipedia.org/wiki/Lindemann_index">Lindemann index</a>,
which is useful to distinguish the melt process and determine the melting points of nano-particles.
The Lindemann index is defined as the root-mean-square bond-length fluctuation with following mathematical expression:</p>
<div class="math notranslate nohighlight">
\[\left\langle\sigma_{i}\right\rangle=\frac{1}{N_{p}(N_{p}-1)} \sum_{j \neq i} \frac{\sqrt{\left\langle r_{i j}^{2}\right\rangle_t-\left\langle r_{i j}\right\rangle_t^{2}}}{\left\langle r_{i j}\right\rangle_t},\]</div>
<p>where <span class="math notranslate nohighlight">\(N_p\)</span> is the particle number, <span class="math notranslate nohighlight">\(r_{ij}\)</span> is the distance between atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> and brackets <span class="math notranslate nohighlight">\(\left\langle \right\rangle_t\)</span>
represents an time average.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is partly referred to a <a class="reference external" href="https://github.com/N720720/lindemann">work</a> on calculating the Lindemann index.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This calculation is high memory requirement. One can estimate the memory by: <span class="math notranslate nohighlight">\(2 * 8 * N_p^2 / 1024^3\)</span> GB.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If only global lindemann index is needed, the class can be calculated in parallel.
The local Lindemann index only run serially due to the dependencies between different frames.
Here we use the <a class="reference external" href="https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Welford">Welford method</a> to
update the varience and mean of <span class="math notranslate nohighlight">\(r_{ij}\)</span>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>only_global</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether only calculate the global index. Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result adds a Lindemann (mdapy.LindemannParameter) class</strong>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can check the results by:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MultiSystem</span><span class="p">(</span><span class="n">filename_list</span><span class="p">)</span> <span class="c1"># Generate a MultiSystem class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span><span class="o">.</span><span class="n">cal_lindemann_parameter</span><span class="p">()</span> <span class="c1"># Calculate Lindemann index.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span><span class="o">.</span><span class="n">Lindemann</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot the Lindemann index.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lindemann&#39;</span><span class="p">]</span> <span class="c1"># Check Lindemann index per particles.</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.MultiSystem.cal_mean_squared_displacement">
<span class="sig-name descname"><span class="pre">cal_mean_squared_displacement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'windows'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#MultiSystem.cal_mean_squared_displacement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.MultiSystem.cal_mean_squared_displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mean squared displacement MSD of system, which can be used to
reflect the particle diffusion trend and describe the melting process. Generally speaking, MSD is an
average displacement over all windows of length <span class="math notranslate nohighlight">\(m\)</span> over the course of the simulation (so-called
‘windows’ mode here) and defined by:</p>
<div class="math notranslate nohighlight">
\[MSD(m) = \frac{1}{N_{p}} \sum_{i=1}^{N_{p}} \frac{1}{N_{f}-m} \sum_{k=0}^{N_{f}-m-1} (\vec{r}_i(k+m) - \vec{r}_i(k))^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(r_i(t)\)</span> is the position of particle <span class="math notranslate nohighlight">\(i\)</span> in frame <span class="math notranslate nohighlight">\(t\)</span>. It is computationally extensive
while using a fast Fourier transform can remarkably reduce the computation cost as described in <a class="reference external" href="https://doi.org/10.1051/sfn/201112010">nMoldyn - Interfacing
spectroscopic experiments, molecular dynamics simulations and models for time correlation functions</a> and discussion in <a class="reference external" href="https://stackoverflow.com/questions/34222272/computing-mean-square-displacement-using-python-and-fft">StackOverflow</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One can install <a class="reference external" href="https://github.com/pyFFTW/pyFFTW">pyfftw</a> to accelerate the calculation,
otherwise mdapy will use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft">scipy.fft</a>
to do the Fourier transform.</p>
</div>
<p>Sometimes one only need the following atomic displacement (so-called ‘direct’ mode here):</p>
<div class="math notranslate nohighlight">
\[MSD(t) = \dfrac{1}{N_p} \sum_{i=1}^{N_p} (r_i(t) - r_i(0))^2.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘windows’ or ‘direct’. Defaults to “windows”.</p>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result adds a MSD (mdapy.MeanSquaredDisplacement) class</strong></p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can check the results by:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">MultiSystem</span><span class="p">(</span><span class="n">filename_list</span><span class="p">)</span> <span class="c1"># Generate a MultiSystem class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span><span class="o">.</span><span class="n">cal_mean_squared_displacement</span><span class="p">()</span> <span class="c1"># Calculate MSD.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span><span class="o">.</span><span class="n">MSD</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot the MSD results.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;msd&#39;</span><span class="p">]</span> <span class="c1"># Check MSD per particles.</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.MultiSystem.write_dumps">
<span class="sig-name descname"><span class="pre">write_dumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#MultiSystem.write_dumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.MultiSystem.write_dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Write all data to a series of DUMP files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_col</strong> (<em>list</em><em>, </em><em>optional</em>) – columns to be saved, such as [‘id’, ‘type’, ‘x’, ‘y’, ‘z’].</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdapy.system.System">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.system.</span></span><span class="sig-name descname"><span class="pre">System</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class can generate a System class for rapidly accessing almost all the analysis
method in mdapy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>mdapy now only supports rectangle box and triclinic system will raise an error.</p></li>
<li><p>mdapy only supports the simplest DATA format, atomic and charge, which means like bond information will cause an error.</p></li>
<li><p>We recommend you use DUMP as input file format or directly give particle positions and box.</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – DATA/DUMP filename. Defaults to None.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘data’ or ‘dump’, One can explicitly assign the file format or mdapy will handle it with the postsuffix of filename. Defaults to None.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box. Defaults to None.</p></li>
<li><p><strong>pos</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions. Defaults to None.</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>, </em><em>optional</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Defaults to [1, 1, 1].</p></li>
<li><p><strong>vel</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles velocities. Defaults to None.</p></li>
<li><p><strong>type_list</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) type per particles. Defaults to 1.</p></li>
<li><p><strong>amass</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_type\)</span>) atomic mass. Defaults to None.</p></li>
<li><p><strong>q</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) atomic charge. Defaults to 0.0.</p></li>
<li><p><strong>data_format</strong> (<em>str</em><em>, </em><em>optional</em>) – <a class="reference external" href="https://docs.lammps.org/read_data.html">‘atomic’ or ‘charge’</a> defined in lammps, format for DATA file. Defaults to None.</p></li>
<li><p><strong>sorted_id</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether sort system data by the particle id. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>data</strong> (pd.DataFrame) - system data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>There are two ways to create a System class.
The first is directly reading from a DUMP/DATA file generated from LAMMPS.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="s1">&#39;example.dump&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>One can also create a System by giving pos, box manually.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">box</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">100.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>
</pre></div>
</div>
<p>Then one can access almost all the analysis method in mdapy with uniform API.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">cal_atomic_entropy</span><span class="p">()</span> <span class="c1"># calculate the atomic entropy</span>
</pre></div>
</div>
<p>One can check the calculation results:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>And easily save it into disk with DUMP/DATA format.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">write_dump</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.atom_distance">
<span class="sig-name descname"><span class="pre">atom_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.atom_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the distance fo atom <span class="math notranslate nohighlight">\(i\)</span> and atom <span class="math notranslate nohighlight">\(j\)</span> considering the periodic boundary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – atom <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
<li><p><strong>j</strong> (<em>int</em>) – atom <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>distance between given two atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.build_neighbor">
<span class="sig-name descname"><span class="pre">build_neighbor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.build_neighbor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.build_neighbor" title="Permalink to this definition">¶</a></dt>
<dd><p>Build neighbor withing a spherical distance based on the mdapy.Neighbor class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 5.0.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 80.</p></li>
<li><p><strong>exclude</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether exclude atom itself. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>verlet_list</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
<li><p><strong>neighbor_number</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>) neighbor atoms number.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_atomic_entropy">
<span class="sig-name descname"><span class="pre">cal_atomic_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_atomic_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_atomic_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the entropy fingerprint, which is useful to distinguish
between ordered and disordered environments, including liquid and solid-like environments,
or glassy and crystalline-like environments. The potential application could identificate grain boundaries
or a solid cluster emerging from the melt. One of the advantages of this parameter is that no a priori
information of structure is required.</p>
<p>This parameter for atom <span class="math notranslate nohighlight">\(i\)</span> is computed using the following formula:</p>
<div class="math notranslate nohighlight">
\[s_S^i=-2\pi\rho k_B \int\limits_0^{r_m} \left [ g(r) \ln g(r) - g(r) + 1 \right ] r^2 dr,\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is a distance, <span class="math notranslate nohighlight">\(g(r)\)</span> is the radial distribution function,
and <span class="math notranslate nohighlight">\(\rho\)</span> is the density of the system.
The <span class="math notranslate nohighlight">\(g(r)\)</span> computed for each atom <span class="math notranslate nohighlight">\(i\)</span> can be noisy and therefore it can be smoothed using:</p>
<div class="math notranslate nohighlight">
\[g_m^i(r) = \frac{1}{4 \pi \rho r^2} \sum\limits_{j} \frac{1}{\sqrt{2 \pi \sigma^2}} e^{-(r-r_{ij})^2/(2\sigma^2)},\]</div>
<p>where the sum over <span class="math notranslate nohighlight">\(j\)</span> goes through the neighbors of atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> is
a parameter to control the smoothing. The average of the parameter over the neighbors of atom <span class="math notranslate nohighlight">\(i\)</span>
is calculated according to:</p>
<div class="math notranslate nohighlight">
\[\left&lt; s_S^i \right&gt;  = \frac{\sum_j s_S^j + s_S^i}{N + 1},\]</div>
<p>where the sum over <span class="math notranslate nohighlight">\(j\)</span> goes over the neighbors of atom <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(N\)</span> is the number of neighbors.
The average version always provides a sharper distinction between order and disorder environments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this module in publication, you should also cite the original paper.</p>
</div>
<p><a class="reference external" href="https://doi.org/10.1063/1.4998408">Entropy based fingerprint for local crystalline order</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class uses the <a class="reference external" href="https://docs.lammps.org/compute_entropy_atom.html">same algorithm with LAMMPS</a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Suggestions for FCC, the <span class="math notranslate nohighlight">\(rc = 1.4a\)</span> and <span class="math notranslate nohighlight">\(average\_rc = 0.9a\)</span> and</p>
</div>
<p>for BCC, the <span class="math notranslate nohighlight">\(rc = 1.8a\)</span> and <span class="math notranslate nohighlight">\(average\_rc = 1.2a\)</span>, where the <span class="math notranslate nohighlight">\(a\)</span>
is the lattice constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 5.0.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – smoothing parameter. Defaults to 0.2.</p></li>
<li><p><strong>use_local_density</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether use local atomic volume. Defaults to False.</p></li>
<li><p><strong>compute_average</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether compute the average version. Defaults to False.</p></li>
<li><p><strong>average_rc</strong> (<em>_type_</em><em>, </em><em>optional</em>) – cutoff distance for averaging operation, if not given, it is equal to rc. This parameter should be lower than rc.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 80.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The entropy is added in self.data[‘atomic_entropy’]</strong>.</p></li>
<li><p><strong>The averaged entropy is added in self.data[‘ave_atomic_entropy’]</strong>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_atomic_temperature">
<span class="sig-name descname"><span class="pre">cal_atomic_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_atomic_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_atomic_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate an average thermal temperature per atom, wchich is useful at shock
simulations. The temperature of atom <span class="math notranslate nohighlight">\(i\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[T_i=\sum^{N^i_{neigh}}_0 m^i_j(v_j^i -v_{COM}^i)^2/(3N_pk_B),\]</div>
<p>where <span class="math notranslate nohighlight">\(N^i_{neigh}\)</span> is neighbor atoms number of atom <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(m^i_j\)</span> and <span class="math notranslate nohighlight">\(v^i_j\)</span> are the atomic mass and velocity of neighbor atom <span class="math notranslate nohighlight">\(j\)</span> of atom <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant and <span class="math notranslate nohighlight">\(N_p\)</span> is the number of particles in system, <span class="math notranslate nohighlight">\(v^i_{COM}\)</span> is
the center of mass COM velocity of neighbor of atom <span class="math notranslate nohighlight">\(i\)</span> and is given by:</p>
<div class="math notranslate nohighlight">
\[v^i_{COM}=\frac{\sum _0^{N^i_{neigh}}m^i_jv_j^i}{\sum_0^{N^i_{neigh}} m_j^i}.\]</div>
<p>Here the neighbor of atom <span class="math notranslate nohighlight">\(i\)</span> includes itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amass</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_{type}\)</span>) atomic mass per species.</p></li>
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 5.0.</p></li>
<li><p><strong>units</strong> (<em>str</em><em>, </em><em>optional</em>) – units selected from [‘metal’, ‘charge’]. Defaults to “metal”.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 80.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result is added in self.data[‘atomic_temp’]</strong>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_centro_symmetry_parameter">
<span class="sig-name descname"><span class="pre">cal_centro_symmetry_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_centro_symmetry_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_centro_symmetry_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the CentroSymmetry Parameter (CSP),
which is heluful to recgonize the structure in lattice, such as FCC and BCC.
The  CSP is given by:</p>
<div class="math notranslate nohighlight">
\[p_{\mathrm{CSP}} = \sum_{i=1}^{N/2}{|\mathbf{r}_i + \mathbf{r}_{i+N/2}|^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(r_i\)</span> and <span class="math notranslate nohighlight">\(r_{i+N/2}\)</span> are two neighbor vectors from the central atom to a pair of opposite neighbor atoms.
For ideal centrosymmetric crystal, the contributions of all neighbor pairs will be zero. Atomic sites within a defective
crystal region, in contrast, typically have a positive CSP value.</p>
<p>This parameter <span class="math notranslate nohighlight">\(N\)</span> indicates the number of nearest neighbors that should be taken into account when computing
the centrosymmetry value for an atom. Generally, it should be a positive, even integer. Note that larger number decreases the
calculation speed. For FCC is 12 and BCC is 8.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this module in publication, you should also cite the original paper.</p>
</div>
<p><a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.58.11085">Kelchner C L, Plimpton S J, Hamilton J C. Dislocation nucleation and defect
structure during surface indentation[J]. Physical review B, 1998, 58(17): 11085.</a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The CSP is calculated by the <a class="reference external" href="https://docs.lammps.org/compute_centro_atom.html">same algorithm as LAMMPS</a>.</p>
</div>
<p>First calculate all <span class="math notranslate nohighlight">\(N (N - 1) / 2\)</span> pairs of neighbor atoms, and the summation of the <span class="math notranslate nohighlight">\(N/2\)</span> lowest weights
is CSP values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>N</strong> (<em>int</em><em>, </em><em>optional</em>) – neighbor atom number considered, should be a positive and even number. Defaults to 12.</p>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result is added in self.data[‘csp’]</strong>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_cluster_analysis">
<span class="sig-name descname"><span class="pre">cal_cluster_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_cluster_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_cluster_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide atoms connected within a given cutoff distance into a cluster.
It is helpful to recognize the reaction products or fragments under shock loading.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class use the <a class="reference external" href="https://www.ovito.org/docs/current/reference/pipelines/modifiers/cluster_analysis.html#particles-modifiers-cluster-analysis">same method as in Ovito</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance.. Defaults to 5.0.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 80.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cluster number.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The cluster id per atom is added in self.data[‘cluster_id’]</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_common_neighbor_analysis">
<span class="sig-name descname"><span class="pre">cal_common_neighbor_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_common_neighbor_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_common_neighbor_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Sse Common Neighbor Analysis (CNA) method to recgonize the lattice structure, based
on which atoms can be divided into FCC, BCC, HCP and Other structure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If one use this module in publication, one should also cite the original paper.
<a class="reference external" href="https://doi.org/10.1016/0927-0256(94)90109-0">Faken D, Jónsson H. Systematic analysis of local atomic structure combined with 3D computer graphics[J].
Computational Materials Science, 1994, 2(2): 279-286.</a>.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>We use the <a class="reference external" href="https://docs.lammps.org/compute_cna_atom.html">same algorithm as in LAMMPS</a>.</p>
</div>
<p>CNA method is sensitive to the given cutoff distance. The suggesting cutoff can be obtained from the
following formulas:</p>
<div class="math notranslate nohighlight">
\[r_{c}^{\mathrm{fcc}} = \frac{1}{2} \left(\frac{\sqrt{2}}{2} + 1\right) a
\approx 0.8536 a,\]</div>
<div class="math notranslate nohighlight">
\[r_{c}^{\mathrm{bcc}} = \frac{1}{2}(\sqrt{2} + 1) a
\approx 1.207 a,\]</div>
<div class="math notranslate nohighlight">
\[r_{c}^{\mathrm{hcp}} = \frac{1}{2}\left(1+\sqrt{\frac{4+2x^{2}}{3}}\right) a,\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the lattice constant and <span class="math notranslate nohighlight">\(x=(c/a)/1.633\)</span> and 1.633 is the ideal ratio of <span class="math notranslate nohighlight">\(c/a\)</span>
in HCP structure.</p>
<p>The CNA method can recgonize the following structure:</p>
<ol class="arabic simple">
<li><p>Other</p></li>
<li><p>FCC</p></li>
<li><p>HCP</p></li>
<li><p>BCC</p></li>
<li><p>ICO</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 3.0.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 30.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The CNA pattern per atom is added in self.data[‘cna’]</strong>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_energy_force">
<span class="sig-name descname"><span class="pre">cal_energy_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_energy_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_energy_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the atomic energy and force based on the given embedded atom method
EAM potential. Multi-elements alloy is also supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename of eam.alloy potential file.</p></li>
<li><p><strong>elements_list</strong> (<em>list</em>) – elements to be calculated, such as [‘Al’, ‘Al’, ‘Ni’] indicates setting type 1 and 2 as ‘Al’ and type 3 as ‘Ni’.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 120.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The energy per atom is added in self.data[‘pe’]</strong>.</p></li>
<li><p><strong>The force per atom is added in self.data[[“afx”, “afy”, “afz”]]</strong>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_pair_distribution">
<span class="sig-name descname"><span class="pre">cal_pair_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_pair_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_pair_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the radiul distribution function (RDF),which
reflects the probability of finding an atom at distance r. The seperate pair-wise
combinations of particle types can also be computed:</p>
<div class="math notranslate nohighlight">
\[g(r) = c_{\alpha}^2 g_{\alpha \alpha}(r) + 2 c_{\alpha} c_{\beta} g_{\alpha \beta}(r) + c_{\beta}^2 g_{\beta \beta}(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{\alpha}\)</span> and <span class="math notranslate nohighlight">\(c_{\beta}\)</span> denote the concentration of two atom types in system
and <span class="math notranslate nohighlight">\(g_{\alpha \beta}(r)=g_{\beta \alpha}(r)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 5.0.</p></li>
<li><p><strong>nbin</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins. Defaults to 200.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 80.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result adds a PairDistribution (mdapy.PairDistribution) class</strong></p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can check the results by:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">PairDistribution</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot gr.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">PairDistribution</span><span class="o">.</span><span class="n">g</span> <span class="c1"># Check partial RDF.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">PairDistribution</span><span class="o">.</span><span class="n">g_total</span> <span class="c1"># Check global RDF.</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_void_distribution">
<span class="sig-name descname"><span class="pre">cal_void_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_void</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_void_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_void_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used to detect the void distribution in solid structure.
First we divid particles into three-dimensional grid and check the its
neighbors, if all neighbor grid is empty we treat this grid is void, otherwise it is
a point defect. Then useing clustering all connected ‘void’ grid into an entire void.
Excepting counting the number and volume of voids, this class can also output the
spatial coordination of void for analyzing the void distribution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The results are sensitive to the selection of <span class="math notranslate nohighlight">\(cell\_length\)</span>, which should
be illustrated if this class is used in your publication.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_length</strong> (<em>float</em>) – length of cell, larger than lattice constant is okay.</p></li>
<li><p><strong>out_void</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether outputs void coordination. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(void_number, void_volume), number and volume of voids.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_voronoi_volume">
<span class="sig-name descname"><span class="pre">cal_voronoi_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_voronoi_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_voronoi_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used to calculate the Voronoi polygon, wchich can be applied to
estimate the atomic volume. The calculation is conducted by the <a class="reference external" href="https://math.lbl.gov/voro++/">voro++</a> package and
this class only provides a wrapper.</p>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The atomic Voronoi volume is added in self.data[‘voronoi_volume’]</strong>.</p></li>
<li><p><strong>The atomic Voronoi neighbor is added in self.data[“voronoi_number”]</strong>.</p></li>
<li><p><strong>The atomic Voronoi cavity radius is added in self.data[“cavity_radius”]</strong>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.cal_warren_cowley_parameter">
<span class="sig-name descname"><span class="pre">cal_warren_cowley_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.cal_warren_cowley_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.cal_warren_cowley_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used to calculate the Warren Cowley parameter (WCP), which is useful to
analyze the short-range order (SRO) in the 1st-nearest neighbor shell in alloy system and is given by:</p>
<div class="math notranslate nohighlight">
\[WCP_{mn} = 1 - Z_{mn}/(X_n Z_{m}),\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_{mn}\)</span> is the number of <span class="math notranslate nohighlight">\(n\)</span>-type atoms around <span class="math notranslate nohighlight">\(m\)</span>-type atoms,
<span class="math notranslate nohighlight">\(Z_m\)</span> is the total number of atoms around <span class="math notranslate nohighlight">\(m\)</span>-type atoms, and <span class="math notranslate nohighlight">\(X_n\)</span> is
the atomic concentration of <span class="math notranslate nohighlight">\(n\)</span>-type atoms in the alloy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this class in publication, you should also cite the original paper:
<a class="reference external" href="https://doi.org/10.1063/1.1699415">X‐Ray Measurement of Order in Single Crystals of Cu3Au</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> (<em>float</em><em>, </em><em>optional</em>) – cutoff distance. Defaults to 3.0.</p></li>
<li><p><strong>max_neigh</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of atom neighbor number. Defaults to 50.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result adds a WarrenCowleyParameter (mdapy.WarrenCowleyParameter) class</strong></p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can check the results by:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">WarrenCowleyParameter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot WCP.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">WarrenCowleyParameter</span><span class="o">.</span><span class="n">WCP</span> <span class="c1"># Check WCP.</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.spatial_binning">
<span class="sig-name descname"><span class="pre">spatial_binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.spatial_binning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.spatial_binning" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used to divide particles into different bins and operating on each bin.
One-dimensional to Three-dimensional binning are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> (<em>str</em>) – binning direction, selected in [‘x’, ‘y’, ‘z’, ‘xy’, ‘xz’, ‘yz’, ‘xyz’].</p></li>
<li><p><strong>vbin</strong> (<em>str/list</em>) – values to be operated, such as ‘x’ or [‘vx’, ‘pe’].</p></li>
<li><p><strong>wbin</strong> (<em>float</em><em>, </em><em>optional</em>) – width of each bin. Defaults to 5.0.</p></li>
<li><p><strong>operation</strong> (<em>str</em><em>, </em><em>optional</em>) – operation on each bin, selected from [‘mean’, ‘sum’, ‘min’, ‘max’]. Defaults to “mean”.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>The result adds a Binning (mdapy.SpatialBinning) class</strong></p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can check the results by:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">Binning</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># Plot the binning results.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">Binning</span><span class="o">.</span><span class="n">res</span> <span class="c1"># Check the binning results.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">Binning</span><span class="o">.</span><span class="n">coor</span> <span class="c1"># Check the binning coordination.</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.wrap_pos">
<span class="sig-name descname"><span class="pre">wrap_pos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.wrap_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.wrap_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap atom position into box considering the periodic boundary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.write_data">
<span class="sig-name descname"><span class="pre">write_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.write_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.write_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to a DATA file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated DATA file.</p></li>
<li><p><strong>data_format</strong> (<em>str</em><em>, </em><em>optional</em>) – selected in [‘atomic’, ‘charge’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.system.System.write_dump">
<span class="sig-name descname"><span class="pre">write_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/system.html#System.write_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.system.System.write_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to a DUMP file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated DUMP file.</p></li>
<li><p><strong>output_col</strong> (<em>list</em><em>, </em><em>optional</em>) – which columns to be saved, which should be inclued in data columns, such as [‘id’, ‘type’, ‘x’, ‘y’, ‘z’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.temperature">
<span id="mdapy-temperature-module"></span><h2>mdapy.temperature module<a class="headerlink" href="#module-mdapy.temperature" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.temperature.AtomicTemperature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.temperature.</span></span><span class="sig-name descname"><span class="pre">AtomicTemperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atype_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'metal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/temperature.html#AtomicTemperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.temperature.AtomicTemperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculated an average thermal temperature per atom, wchich is useful at shock
simulations. The temperature of atom <span class="math notranslate nohighlight">\(i\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[T_i=\sum^{N^i_{neigh}}_0 m^i_j(v_j^i -v_{COM}^i)^2/(3N_pk_B),\]</div>
<p>where <span class="math notranslate nohighlight">\(N^i_{neigh}\)</span> is neighbor atoms number of atom <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(m^i_j\)</span> and <span class="math notranslate nohighlight">\(v^i_j\)</span> are the atomic mass and velocity of neighbor atom <span class="math notranslate nohighlight">\(j\)</span> of atom <span class="math notranslate nohighlight">\(i\)</span>,
<span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant and <span class="math notranslate nohighlight">\(N_p\)</span> is the number of particles in system, <span class="math notranslate nohighlight">\(v^i_{COM}\)</span> is
the center of mass COM velocity of neighbor of atom <span class="math notranslate nohighlight">\(i\)</span> and is given by:</p>
<div class="math notranslate nohighlight">
\[v^i_{COM}=\frac{\sum _0^{N^i_{neigh}}m^i_jv_j^i}{\sum_0^{N^i_{neigh}} m_j^i}.\]</div>
<p>Here the neighbor of atom <span class="math notranslate nohighlight">\(i\)</span> includes itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amass</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_{type}\)</span>) atomic mass.</p></li>
<li><p><strong>vel</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>), atomic velocity.</p></li>
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>distance_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) distance_list[i, j] means distance between i and j atom.</p></li>
<li><p><strong>atype_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>), atomic type.</p></li>
<li><p><strong>rc</strong> (<em>float</em>) – cutoff distance to average.</p></li>
<li><p><strong>units</strong> (<em>str</em><em>, </em><em>optional</em>) – <a class="reference external" href="https://docs.lammps.org/units.html">units</a> defined in LAMMPS, supports <em>metal</em> and <em>charge</em>. Defaults to “metal”.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>T</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>), atomic temperature.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">3.615</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span>
<span class="go">                        5., max_neigh=50) # Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">init_vel</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Mass</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="go">        # Generate random velocity at T K.</span>
<span class="go">        Boltzmann_Constant = 8.617385e-5</span>
<span class="go">        np.random.seed(10086)</span>
<span class="go">        x1 = np.random.random(N * 3)</span>
<span class="go">        x2 = np.random.random(N * 3)</span>
<span class="go">        vel = (</span>
<span class="go">            np.sqrt(T * Boltzmann_Constant / Mass)</span>
<span class="go">            * np.sqrt(-2 * np.log(x1))</span>
<span class="go">            * np.cos(2 * np.pi * x2)</span>
<span class="go">        ).reshape(N, 3)</span>
<span class="go">        vel -= vel.mean(axis=0)</span>
<span class="go">        return vel * 100  # A/ps</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vel</span> <span class="o">=</span> <span class="n">init_vel</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c1"># Generate random velocity at 300 K.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Temp</span> <span class="o">=</span> <span class="n">AtomicTemperature</span><span class="p">(</span>
<span class="go">        np.array([1.0]),</span>
<span class="go">        vel,</span>
<span class="go">        neigh.verlet_list,</span>
<span class="go">        neigh.distance_list,</span>
<span class="go">        np.ones(FCC.N, dtype=int),</span>
<span class="go">        5.0,</span>
<span class="go">    ) # Initilize the temperature class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Temp</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Do the temperature calculation.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Temp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># Average temperature should be close to 300 K.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.temperature.AtomicTemperature.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/temperature.html#AtomicTemperature.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.temperature.AtomicTemperature.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real temperature calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.timer">
<span id="mdapy-timer-module"></span><h2>mdapy.timer module<a class="headerlink" href="#module-mdapy.timer" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mdapy.timer.timer">
<span class="sig-prename descclassname"><span class="pre">mdapy.timer.</span></span><span class="sig-name descname"><span class="pre">timer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/timer.html#timer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.timer.timer" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorators function for timing.</p>
</dd></dl>

</section>
<section id="module-mdapy.void_distribution">
<span id="mdapy-void-distribution-module"></span><h2>mdapy.void_distribution module<a class="headerlink" href="#module-mdapy.void_distribution" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.void_distribution.VoidDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.void_distribution.</span></span><span class="sig-name descname"><span class="pre">VoidDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_void</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'void.dump'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/void_distribution.html#VoidDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.void_distribution.VoidDistribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to detect the void distribution in solid structure.
First we divid particles into three-dimensional grid and check the its
neighbors, if all neighbor grid is empty we treat this grid is void, otherwise it is
a point defect. Then useing clustering all connected ‘void’ grid into an entire void.
Excepting counting the number and volume of voids, this class can also output the
spatial coordination of void for analyzing the void distribution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The results are sensitive to the selection of <span class="math notranslate nohighlight">\(cell\_length\)</span>, which should
be illustrated if this class is used in your publication.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box.</p></li>
<li><p><strong>cell_length</strong> (<em>float</em>) – length of cell, larger than lattice constant is okay.</p></li>
<li><p><strong>boundary</strong> (<em>list</em><em>, </em><em>optional</em>) – boundary conditions, 1 is periodic and 0 is free boundary. Defaults to [1, 1, 1].</p></li>
<li><p><strong>out_void</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether outputs void coordination. Defaults to False.</p></li>
<li><p><strong>head</strong> (<em>list</em><em>, </em><em>optional</em>) – header of void DUMP file. Defaults to None.</p></li>
<li><p><strong>out_name</strong> (<em>str</em><em>, </em><em>optional</em>) – filename of generated void DUMP file. Defaults to “void.dump”.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>void_number</strong> (int) - total number of voids.</p></li>
<li><p><strong>void_volume</strong> (float) - total volume of voids</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">4.05</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="c1"># Create a FCC structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions.</span>
</pre></div>
</div>
<p>Generate four voids.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">400</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">400</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">void</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">VoidDistribution</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="n">out_void</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Initilize void class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">void</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculated the voids and generate a file named void.dump.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">void</span><span class="o">.</span><span class="n">void_number</span> <span class="c1"># Check the void number, should be 4 here.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">void</span><span class="o">.</span><span class="n">void_volume</span> <span class="c1"># Check the void volume.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.void_distribution.VoidDistribution.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/void_distribution.html#VoidDistribution.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.void_distribution.VoidDistribution.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real void calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.voronoi_analysis">
<span id="mdapy-voronoi-analysis-module"></span><h2>mdapy.voronoi_analysis module<a class="headerlink" href="#module-mdapy.voronoi_analysis" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.voronoi_analysis.VoronoiAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.voronoi_analysis.</span></span><span class="sig-name descname"><span class="pre">VoronoiAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/voronoi_analysis.html#VoronoiAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.voronoi_analysis.VoronoiAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the Voronoi polygon, wchich can be applied to
estimate the atomic volume. The calculation is conducted by the <a class="reference external" href="https://math.lbl.gov/voro++/">voro++</a> package and
this class only provides a wrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, 3\)</span>) particles positions.</p></li>
<li><p><strong>box</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(3, 2\)</span>) system box.</p></li>
<li><p><strong>boundary</strong> (<em>list</em>) – boundary conditions, 1 is periodic and 0 is free boundary, such as [1, 1, 1].</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>vol</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>), atom Voronoi volume.</p></li>
<li><p><strong>neighbor_number</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_p\)</span>), atom Voronoi neighbor number.</p></li>
<li><p><strong>cavity_radius</strong> (np.ndarray) - the distance from the particle to the farthest vertex of its Voronoi cell.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">LatticeMaker</span><span class="p">(</span><span class="mf">4.05</span><span class="p">,</span> <span class="s1">&#39;FCC&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Create a FCC structure.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FCC</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Get atom positions.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avol</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">VoronoiAnalysis</span><span class="p">(</span><span class="n">FCC</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># Initilize the Voronoi class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avol</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the Voronoi volume.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avol</span><span class="o">.</span><span class="n">vol</span> <span class="c1"># Check atomic Voronoi volume.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avol</span><span class="o">.</span><span class="n">neighbor_number</span> <span class="c1"># Check neighbor number.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avol</span><span class="o">.</span><span class="n">cavity_radius</span> <span class="c1"># Check the cavity radius.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.voronoi_analysis.VoronoiAnalysis.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/voronoi_analysis.html#VoronoiAnalysis.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.voronoi_analysis.VoronoiAnalysis.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real Voronoi volume calculation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy.warren_cowley_parameter">
<span id="mdapy-warren-cowley-parameter-module"></span><h2>mdapy.warren_cowley_parameter module<a class="headerlink" href="#module-mdapy.warren_cowley_parameter" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mdapy.warren_cowley_parameter.WarrenCowleyParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdapy.warren_cowley_parameter.</span></span><span class="sig-name descname"><span class="pre">WarrenCowleyParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verlet_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/warren_cowley_parameter.html#WarrenCowleyParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.warren_cowley_parameter.WarrenCowleyParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is used to calculate the Warren Cowley parameter (WCP), which is useful to
analyze the short-range order (SRO) in the 1st-nearest neighbor shell in alloy system and is given by:</p>
<div class="math notranslate nohighlight">
\[WCP_{mn} = 1 - Z_{mn}/(X_n Z_{m}),\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_{mn}\)</span> is the number of <span class="math notranslate nohighlight">\(n\)</span>-type atoms around <span class="math notranslate nohighlight">\(m\)</span>-type atoms,
<span class="math notranslate nohighlight">\(Z_m\)</span> is the total number of atoms around <span class="math notranslate nohighlight">\(m\)</span>-type atoms, and <span class="math notranslate nohighlight">\(X_n\)</span> is
the atomic concentration of <span class="math notranslate nohighlight">\(n\)</span>-type atoms in the alloy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use this class in publication, you should also cite the original paper:
<a class="reference external" href="https://doi.org/10.1063/1.1699415">X‐Ray Measurement of Order in Single Crystals of Cu3Au</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verlet_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p, max\_neigh\)</span>) verlet_list[i, j] means j atom is a neighbor of i atom if j &gt; -1.</p></li>
<li><p><strong>neighbor_number</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) neighbor atoms number.</p></li>
<li><p><strong>type_list</strong> (<em>np.ndarray</em>) – (<span class="math notranslate nohighlight">\(N_p\)</span>) atom type.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>WCP</strong> (np.ndarray) - (<span class="math notranslate nohighlight">\(N_{type}, N_{type}\)</span>) WCP for all pair elements</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdapy</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="s2">&quot;./example/CoCuFeNiPd-4M.dump&quot;</span><span class="p">)</span> <span class="c1"># Read a alloy DUMP file.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Neighbor</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">box</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">max_neigh</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span> <span class="c1"># Initialize Neighbor class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate particle neighbor information.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wcp</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">WarrenCowleyParameter</span><span class="p">(</span>
<span class="go">    neigh.verlet_list, neigh.neighbor_number, system.data[&quot;type&quot;].values</span>
<span class="go">    ) # Initilize the WCP class.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wcp</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># Calculate the WCP.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wcp</span><span class="o">.</span><span class="n">WCP</span> <span class="c1"># Check the WCP matrix.</span>
</pre></div>
</div>
<p>This should get the same results with that in paper: <a class="reference external" href="https://doi.org/10.1038/s41467-021-25264-5">Simultaneously enhancing the ultimate strength and ductility of high-entropy alloys via short-range ordering</a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wcp</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s2">&quot;Co&quot;</span><span class="p">,</span> <span class="s2">&quot;Cu&quot;</span><span class="p">,</span> <span class="s2">&quot;Fe&quot;</span><span class="p">,</span> <span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;Pd&quot;</span><span class="p">])</span> <span class="c1"># Plot the results.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mdapy.warren_cowley_parameter.WarrenCowleyParameter.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/warren_cowley_parameter.html#WarrenCowleyParameter.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.warren_cowley_parameter.WarrenCowleyParameter.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the real WCP calculation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdapy.warren_cowley_parameter.WarrenCowleyParameter.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GnBu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy/warren_cowley_parameter.html#WarrenCowleyParameter.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.warren_cowley_parameter.WarrenCowleyParameter.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the WCP matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements_list</strong> (<em>list</em><em>, </em><em>optional</em>) – elements list, such as [‘Al’, ‘Ni’, ‘Co’].</p></li>
<li><p><strong>vmin</strong> (<em>int</em><em>, </em><em>optional</em>) – vmin for colorbar. Defaults to -2.</p></li>
<li><p><strong>vmax</strong> (<em>int</em><em>, </em><em>optional</em>) – vmax for colorbar. Defaults to 1.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – cmap name. Defaults to “GnBu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fig, ax) matplotlib figure and axis class.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mdapy">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mdapy" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mdapy.init">
<span class="sig-prename descclassname"><span class="pre">mdapy.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu_max_num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offline_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">packed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_memory_GB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_profiler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdapy.html#init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdapy.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initilize the mdapy calculation. One should call this function after import mdapy.
This is a simple wrapper function of <a class="reference external" href="https://docs.taichi-lang.org/api/taichi/#taichi.init">taichi.init()</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arch</strong> (<em>str</em><em>, </em><em>optional</em>) – run on CPU or GPU. Defaults to “cpu”, choose in ‘cpu’ and ‘gpu’.</p></li>
<li><p><strong>cpu_max_num_threads</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum CPU core to use in calculation. Defaults to -1, indicating using all available CPU cores.</p></li>
<li><p><strong>offline_cache</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether save compile cache. Defaults to False.</p></li>
<li><p><strong>packed</strong> (<em>bool</em><em>, </em><em>optional</em>) – memory allocate mode. Defaults to False.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether use debug mode. Defaults to False.</p></li>
<li><p><strong>device_memory_GB</strong> (<em>float</em><em>, </em><em>optional</em>) – available GPU memory. Defaults to 2.0 GB.</p></li>
<li><p><strong>kernel_profiler</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether enable profiler. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Unrecognized arch, please choose in [‘cpu’, ‘gpu’].</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="mdapy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, mushroomfire.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>